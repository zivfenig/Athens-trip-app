:root {
  --blue:       #1a6fb5;
  --blue-light: #3a9fd8;
  --blue-dark:  #0d4a82;
  --gold:       #d4a843;
  --bg:         #0a1628;
  --surface:    #111f38;
  --surface2:   #162440;
  --text:       #e8f0fb;
  --text-dim:   #8ba0c0;
  --border:     rgba(58,159,216,0.15);
  --shadow:     0 8px 32px rgba(0,0,0,0.4);
  --radius:     16px;
  --green:      #2dd4a0;
  --orange:     #f5874a;
  --red:        #e85555;
  --purple:     #9b72f0;
}
* { box-sizing:border-box; margin:0; padding:0; }
body {
  font-family:'Heebo',sans-serif;
  background:var(--bg); color:var(--text);
  min-height:100vh; overflow-x:hidden; direction:rtl;
}

/* ── LOGIN ─────────────────────────────────────────────────── */
#loginScreen {
  min-height:100vh; display:flex; align-items:center; justify-content:center;
  background:radial-gradient(ellipse at 30% 20%,rgba(26,111,181,.3) 0%,transparent 60%),
             radial-gradient(ellipse at 80% 80%,rgba(212,168,67,.15) 0%,transparent 50%),
             var(--bg);
  padding:20px;
}
.login-card {
  background:var(--surface); border:1px solid var(--border); border-radius:24px;
  padding:40px 32px; width:100%; max-width:380px; text-align:center;
  box-shadow:var(--shadow),0 0 60px rgba(26,111,181,.1);
}
.login-logo  { font-size:52px; margin-bottom:8px; }
.login-title { font-size:26px; font-weight:900; color:var(--gold); margin-bottom:4px; }
.login-sub   { font-size:14px; color:var(--text-dim); margin-bottom:32px; }
.login-input {
  width:100%; background:var(--bg); border:1px solid var(--border); border-radius:12px;
  padding:14px 16px; color:var(--text); font-family:'Heebo',sans-serif; font-size:16px;
  text-align:right; margin-bottom:16px; outline:none; transition:border-color .2s;
}
.login-input:focus { border-color:var(--blue-light); }
.login-btn {
  width:100%; background:linear-gradient(135deg,var(--blue),var(--blue-dark));
  color:white; border:none; border-radius:12px; padding:14px;
  font-family:'Heebo',sans-serif; font-size:16px; font-weight:700;
  cursor:pointer; box-shadow:0 4px 20px rgba(26,111,181,.4); transition:transform .15s;
}
.login-btn:active { transform:scale(.97); }
.login-error { font-size:13px; color:var(--red); margin-top:10px; min-height:20px; }

/* ── TOP BAR ───────────────────────────────────────────────── */
#app { display:none; }
.top-bar {
  position:sticky; top:0; z-index:100;
  background:rgba(10,22,40,.95); backdrop-filter:blur(12px);
  border-bottom:1px solid var(--border);
  padding:10px 14px; display:flex; align-items:center; justify-content:space-between; gap:8px;
}
.top-bar-title { font-size:15px; font-weight:700; color:var(--gold); flex-shrink:0; }
.top-bar-right { display:flex; align-items:center; gap:6px; flex-wrap:wrap; justify-content:flex-end; }
.top-bar-user  { font-size:13px; color:var(--text-dim); }
.admin-badge   { background:var(--gold); color:#000; font-size:10px; font-weight:700; padding:2px 6px; border-radius:6px; }
.logout-btn    { background:none; border:1px solid var(--border); color:var(--text-dim); border-radius:8px; padding:4px 10px; font-size:12px; cursor:pointer; font-family:'Heebo',sans-serif; }
.key-status-btn {
  background:rgba(155,114,240,.1); border:1px solid rgba(155,114,240,.4); color:var(--purple);
  border-radius:8px; padding:4px 10px; font-size:11px; font-weight:700;
  cursor:pointer; font-family:'Heebo',sans-serif; white-space:nowrap;
}

/* ── BOTTOM NAV ────────────────────────────────────────────── */
.bottom-nav {
  position:fixed; bottom:0; left:0; right:0; z-index:100;
  background:rgba(10,22,40,.97); backdrop-filter:blur(12px);
  border-top:1px solid var(--border);
  display:flex; padding:8px 0 env(safe-area-inset-bottom,8px);
}
.nav-item {
  flex:1; display:flex; flex-direction:column; align-items:center; gap:3px;
  padding:6px 4px; cursor:pointer; border:none; background:none;
  color:var(--text-dim); font-family:'Heebo',sans-serif; font-size:10px;
  transition:color .2s; -webkit-tap-highlight-color:transparent;
}
.nav-item.active { color:var(--blue-light); }
.nav-icon { font-size:22px; }

/* ── PAGES ─────────────────────────────────────────────────── */
.page { display:none; padding:16px 16px 100px; animation:fadeIn .25s ease; }
.page.active { display:block; }
@keyframes fadeIn { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none} }

/* ── EXPENSE SUMMARY ───────────────────────────────────────── */
.expense-summary { background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:16px; margin-bottom:16px; }
.expense-summary-title { font-size:13px; color:var(--text-dim); margin-bottom:12px; font-weight:500; }
.total-amount  { font-size:32px; font-weight:900; color:var(--gold); margin-bottom:4px; }
.total-label   { font-size:12px; color:var(--text-dim); margin-bottom:16px; }
.cat-bars      { display:flex; flex-direction:column; gap:8px; }
.cat-bar-row   { display:flex; align-items:center; gap:10px; }
.cat-bar-label { font-size:12px; width:70px; color:var(--text); text-align:right; flex-shrink:0; }
.cat-bar-track { flex:1; height:8px; background:rgba(255,255,255,.06); border-radius:4px; overflow:hidden; }
.cat-bar-fill  { height:100%; border-radius:4px; transition:width .5s ease; }
.cat-bar-amount{ font-size:11px; color:var(--text-dim); width:60px; text-align:left; flex-shrink:0; }

/* ── HEADERS ───────────────────────────────────────────────── */
.section-title  { font-size:18px; font-weight:900; margin-bottom:12px; color:var(--text); display:flex; align-items:center; gap:8px; }
.page-header    { font-size:22px; font-weight:900; margin-bottom:4px; }
.page-subheader { font-size:13px; color:var(--text-dim); margin-bottom:16px; }

/* ── TRIP HERO ─────────────────────────────────────────────── */
.trip-hero {
  background:linear-gradient(135deg,rgba(26,111,181,.3),rgba(10,22,40,0));
  border:1px solid var(--border); border-radius:var(--radius);
  padding:20px; margin-bottom:16px; text-align:center;
}
.trip-hero-emoji { font-size:48px; margin-bottom:8px; }
.trip-hero-title { font-size:24px; font-weight:900; color:var(--gold); }
.trip-hero-sub   { font-size:13px; color:var(--text-dim); margin-top:4px; }
.trip-stats      { display:flex; gap:10px; margin-top:16px; }
.trip-stat       { flex:1; background:rgba(255,255,255,.04); border-radius:10px; padding:10px; text-align:center; }
.trip-stat-num   { font-size:22px; font-weight:900; color:var(--blue-light); }
.trip-stat-label { font-size:11px; color:var(--text-dim); margin-top:2px; }

/* ── SUMMARY DAY CARD ──────────────────────────────────────── */
.summary-day-card {
  background:var(--surface); border:1px solid var(--border); border-radius:12px;
  padding:14px; margin-bottom:10px; cursor:pointer; transition:border-color .2s;
}
.summary-day-card:hover { border-color:var(--blue-light); }

/* ── DAY TABS ──────────────────────────────────────────────── */
.day-tabs { display:flex; gap:8px; overflow-x:auto; padding-bottom:8px; margin-bottom:16px; scrollbar-width:none; }
.day-tabs::-webkit-scrollbar { display:none; }
.day-tab {
  flex-shrink:0; background:var(--surface); border:1px solid var(--border); border-radius:12px;
  padding:8px 16px; cursor:pointer; font-family:'Heebo',sans-serif; font-size:13px; font-weight:500;
  color:var(--text-dim); transition:all .2s; -webkit-tap-highlight-color:transparent;
}
.day-tab.active { background:var(--blue); border-color:var(--blue); color:white; font-weight:700; }

/* ── ATTRACTION CARD ───────────────────────────────────────── */
.attr-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:var(--radius); padding:16px; margin-bottom:12px;
  position:relative; overflow:hidden;
}
.attr-card::before {
  content:''; position:absolute; right:0; top:0; bottom:0; width:3px;
  background:linear-gradient(180deg,var(--blue-light),var(--blue-dark));
}
.attr-order {
  position:absolute; left:14px; top:14px; background:var(--blue); color:white;
  width:26px; height:26px; border-radius:50%; display:flex; align-items:center;
  justify-content:center; font-size:12px; font-weight:700;
}
.attr-name    { font-size:17px; font-weight:700; margin-bottom:4px; padding-left:36px; }
.attr-desc    { font-size:13px; color:var(--text-dim); margin-bottom:4px; line-height:1.5; }
.attr-time    { font-size:12px; color:var(--gold); margin-bottom:12px; }
.attr-actions { display:flex; gap:8px; flex-wrap:wrap; }
.attr-btn {
  flex:1; min-width:0; display:flex; align-items:center; justify-content:center; gap:6px;
  padding:10px 8px; border-radius:10px; border:none;
  font-family:'Heebo',sans-serif; font-size:13px; font-weight:600;
  cursor:pointer; transition:transform .15s,opacity .15s;
  -webkit-tap-highlight-color:transparent; text-decoration:none;
}
.attr-btn:active    { transform:scale(.95); opacity:.85; }
.btn-nav            { background:linear-gradient(135deg,var(--green),#1fa87a); color:#000; }
.btn-info           { background:var(--surface2); color:var(--text); border:1px solid var(--border); }
.btn-edit           { background:rgba(212,168,67,.15); color:var(--gold); border:1px solid rgba(212,168,67,.3); }
.btn-delete         { background:rgba(232,85,85,.1); color:var(--red); border:1px solid rgba(232,85,85,.3); }
.attr-connector     { text-align:center; color:var(--text-dim); font-size:11px; margin:4px 0 8px; display:flex; align-items:center; gap:8px; }
.attr-connector::before,.attr-connector::after { content:''; flex:1; height:1px; background:var(--border); }

/* ── ACTION BUTTONS ────────────────────────────────────────── */
.optimize-btn {
  width:100%; background:linear-gradient(135deg,rgba(155,114,240,.2),rgba(26,111,181,.2));
  border:1px solid rgba(155,114,240,.4); color:var(--purple);
  border-radius:12px; padding:12px; font-family:'Heebo',sans-serif;
  font-size:14px; font-weight:700; cursor:pointer; margin-bottom:16px;
  display:flex; align-items:center; justify-content:center; gap:8px;
  transition:transform .15s; -webkit-tap-highlight-color:transparent;
}
.optimize-btn:active { transform:scale(.97); }
.add-btn {
  width:100%; background:rgba(26,111,181,.1); border:1px dashed rgba(58,159,216,.4);
  color:var(--blue-light); border-radius:12px; padding:14px;
  font-family:'Heebo',sans-serif; font-size:14px; font-weight:600; cursor:pointer;
  display:flex; align-items:center; justify-content:center; gap:8px;
  -webkit-tap-highlight-color:transparent;
}

/* ── FORMS ─────────────────────────────────────────────────── */
.expense-form-card { background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:16px; margin-bottom:16px; }
.form-label  { font-size:12px; color:var(--text-dim); margin-bottom:6px; display:block; }
.form-input,.form-select,.form-textarea {
  width:100%; background:var(--bg); border:1px solid var(--border); border-radius:10px;
  padding:12px; color:var(--text); font-family:'Heebo',sans-serif; font-size:15px;
  text-align:right; outline:none; margin-bottom:12px; transition:border-color .2s;
}
.form-input:focus,.form-select:focus,.form-textarea:focus { border-color:var(--blue-light); }
.form-row       { display:flex; gap:10px; }
.form-row > div { flex:1; }
.currency-toggle { display:flex; gap:8px; margin-bottom:12px; }
.currency-btn {
  flex:1; padding:10px; border-radius:10px; border:1px solid var(--border);
  background:var(--bg); color:var(--text-dim);
  font-family:'Heebo',sans-serif; font-size:14px; font-weight:600; cursor:pointer; transition:all .2s;
}
.currency-btn.active { background:var(--blue); border-color:var(--blue); color:white; }
.add-expense-btn {
  width:100%; background:linear-gradient(135deg,var(--green),#1fa87a); color:#000;
  border:none; border-radius:12px; padding:14px; font-family:'Heebo',sans-serif;
  font-size:15px; font-weight:700; cursor:pointer; transition:transform .15s; -webkit-tap-highlight-color:transparent;
}
.add-expense-btn:active { transform:scale(.97); }

/* ── EXPENSE LIST ──────────────────────────────────────────── */
.expense-item {
  background:var(--surface); border:1px solid var(--border); border-radius:12px;
  padding:14px; margin-bottom:10px; display:flex; align-items:flex-start;
  justify-content:space-between; gap:12px;
}
.expense-item-cat      { font-size:20px; flex-shrink:0; }
.expense-item-info     { flex:1; min-width:0; }
.expense-item-cat-name { font-size:12px; color:var(--text-dim); }
.expense-item-desc     { font-size:14px; font-weight:500; margin-top:2px; word-break:break-word; }
.expense-item-amount   { font-size:17px; font-weight:900; color:var(--gold); }
.expense-item-del      { background:none; border:none; color:var(--red); cursor:pointer; font-size:18px; padding:4px; }

.exp-action-row { display:flex; gap:10px; margin-bottom:12px; }
.convert-btn {
  flex:1; background:rgba(212,168,67,.1); border:1px solid rgba(212,168,67,.3); color:var(--gold);
  border-radius:12px; padding:12px; font-family:'Heebo',sans-serif; font-size:13px; font-weight:700;
  cursor:pointer; display:flex; align-items:center; justify-content:center; gap:6px;
}
.csv-btn {
  flex:1; background:rgba(45,212,160,.1); border:1px solid rgba(45,212,160,.3); color:var(--green);
  border-radius:12px; padding:12px; font-family:'Heebo',sans-serif; font-size:13px; font-weight:700;
  cursor:pointer; display:flex; align-items:center; justify-content:center; gap:6px;
}
.ai-analyze-btn {
  width:100%; background:linear-gradient(135deg,rgba(155,114,240,.25),rgba(26,111,181,.2));
  border:1px solid rgba(155,114,240,.5); color:var(--purple);
  border-radius:12px; padding:14px; font-family:'Heebo',sans-serif;
  font-size:15px; font-weight:700; cursor:pointer; margin-bottom:16px;
  display:flex; align-items:center; justify-content:center; gap:8px;
  transition:transform .15s; -webkit-tap-highlight-color:transparent;
}
.ai-analyze-btn:active { transform:scale(.97); }
.ai-result { background:var(--surface); border:1px solid rgba(155,114,240,.3); border-radius:var(--radius); padding:20px; margin-bottom:16px; font-size:14px; line-height:1.8; }
.ai-result h3 { font-size:17px; font-weight:700; color:var(--purple); margin-bottom:12px; }

.cat-chips { display:flex; gap:8px; overflow-x:auto; padding-bottom:8px; margin-bottom:12px; scrollbar-width:none; }
.cat-chips::-webkit-scrollbar { display:none; }
.cat-chip {
  flex-shrink:0; padding:6px 14px; border-radius:20px; border:1px solid var(--border);
  background:var(--surface); color:var(--text-dim);
  font-family:'Heebo',sans-serif; font-size:13px; font-weight:500;
  cursor:pointer; transition:all .2s; -webkit-tap-highlight-color:transparent;
}
.cat-chip.active { color:white; border-color:transparent; }

/* ── MAP ───────────────────────────────────────────────────── */
#mapContainer { width:100%; height:calc(100vh - 160px); border-radius:var(--radius); overflow:hidden; border:1px solid var(--border); }
#mapContainer iframe { width:100%; height:100%; border:none; }

/* ── CHAT ──────────────────────────────────────────────────── */
.chat-wrapper {
  display:flex; flex-direction:column;
  height:calc(100vh - 170px);
  min-height:400px;
}
.chat-header {
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:12px;
}
.chat-clear-btn {
  background:rgba(255,255,255,.05); border:1px solid var(--border); color:var(--text-dim);
  border-radius:8px; padding:6px 12px; font-family:'Heebo',sans-serif; font-size:12px;
  cursor:pointer;
}
.chat-messages {
  flex:1; overflow-y:auto; padding:4px 0 12px;
  display:flex; flex-direction:column; gap:12px;
  scrollbar-width:thin; scrollbar-color:var(--border) transparent;
}
.chat-messages::-webkit-scrollbar { width:4px; }
.chat-messages::-webkit-scrollbar-thumb { background:var(--border); border-radius:4px; }
.chat-row      { display:flex; }
.chat-row-user { justify-content:flex-start; }
.chat-row-ai   { justify-content:flex-end; }
.chat-bubble {
  max-width:80%; padding:12px 16px; border-radius:18px;
  font-size:14px; line-height:1.6; word-break:break-word;
}
.chat-bubble-user {
  background:var(--blue); color:white;
  border-bottom-right-radius:6px;
}
.chat-bubble-ai {
  background:var(--surface2); color:var(--text);
  border:1px solid var(--border); border-bottom-left-radius:6px;
}
.chat-input-row {
  display:flex; gap:10px; align-items:flex-end;
  padding-top:10px; border-top:1px solid var(--border);
}
.chat-input {
  flex:1; background:var(--surface); border:1px solid var(--border); border-radius:14px;
  padding:12px 14px; color:var(--text); font-family:'Heebo',sans-serif; font-size:15px;
  text-align:right; outline:none; resize:none; line-height:1.5; min-height:46px; max-height:120px;
  transition:border-color .2s;
}
.chat-input:focus { border-color:var(--blue-light); }
.chat-send-btn {
  width:46px; height:46px; flex-shrink:0;
  background:var(--blue); border:none; border-radius:14px; color:white;
  font-size:20px; cursor:pointer; display:flex; align-items:center; justify-content:center;
  transition:transform .15s, opacity .15s; -webkit-tap-highlight-color:transparent;
}
.chat-send-btn:active { transform:scale(.92); }
.chat-send-btn:disabled { opacity:.4; cursor:not-allowed; }
.chat-hint { font-size:11px; color:var(--text-dim); text-align:center; margin-top:6px; }

/* Typing indicator */
.typing-dot {
  display:inline-block; width:7px; height:7px; border-radius:50%;
  background:var(--text-dim); margin:0 2px;
  animation:typingBounce 1.2s infinite ease-in-out;
}
.typing-dot:nth-child(2) { animation-delay:.2s; }
.typing-dot:nth-child(3) { animation-delay:.4s; }
@keyframes typingBounce { 0%,60%,100%{transform:translateY(0)} 30%{transform:translateY(-6px)} }

/* ── SPINNER / LOADING ─────────────────────────────────────── */
.search-loading { text-align:center; padding:40px; color:var(--text-dim); font-size:14px; }
.spinner {
  display:inline-block; width:24px; height:24px;
  border:3px solid var(--border); border-top-color:var(--blue-light);
  border-radius:50%; animation:spin .8s linear infinite; margin-bottom:12px;
}
@keyframes spin { to{transform:rotate(360deg)} }

/* ── RATE TAG ──────────────────────────────────────────────── */
.rate-tag {
  display:inline-flex; align-items:center; gap:6px;
  background:rgba(45,212,160,.1); border:1px solid rgba(45,212,160,.3);
  color:var(--green); border-radius:20px; padding:4px 12px;
  font-size:12px; font-weight:600; margin-bottom:16px;
}
.rate-tag.stale { background:rgba(245,135,74,.1); border-color:rgba(245,135,74,.3); color:var(--orange); }

/* ── MODAL ─────────────────────────────────────────────────── */
.modal-overlay {
  position:fixed; inset:0; z-index:200; background:rgba(0,0,0,.7);
  display:flex; align-items:flex-end; justify-content:center;
  opacity:0; pointer-events:none; transition:opacity .25s;
}
.modal-overlay.open { opacity:1; pointer-events:all; }
.modal {
  background:var(--surface); border:1px solid var(--border);
  border-radius:24px 24px 0 0; padding:24px 20px 40px;
  width:100%; max-width:600px; max-height:85vh; overflow-y:auto;
  transform:translateY(100%); transition:transform .3s cubic-bezier(.34,1.2,.64,1);
  position:relative;
}
.modal-overlay.open .modal { transform:none; }
.modal-handle  { width:40px; height:4px; background:var(--border); border-radius:2px; margin:0 auto 20px; }
.modal-title   { font-size:20px; font-weight:900; margin-bottom:20px; color:var(--gold); }
.modal-close   { position:absolute; left:20px; top:24px; background:none; border:none; color:var(--text-dim); font-size:24px; cursor:pointer; }
.modal-body    { font-size:14px; line-height:1.8; }
.modal-body h4 { color:var(--blue-light); margin:12px 0 4px; font-size:13px; text-transform:uppercase; letter-spacing:.5px; }
.save-btn      { width:100%; background:var(--blue); border:none; border-radius:12px; padding:14px; color:white; font-family:'Heebo',sans-serif; font-size:15px; font-weight:700; cursor:pointer; margin-top:16px; }

/* ── TOAST ─────────────────────────────────────────────────── */
.toast {
  position:fixed; bottom:80px; left:50%;
  transform:translateX(-50%) translateY(20px);
  background:var(--surface2); border:1px solid var(--border); color:var(--text);
  padding:12px 24px; border-radius:12px; font-size:14px; z-index:300;
  opacity:0; transition:all .3s; pointer-events:none; white-space:nowrap; box-shadow:var(--shadow);
}
.toast.show { opacity:1; transform:translateX(-50%) translateY(0); }

select option { background:#1a2e50; }

/* ── RESTAURANTS ───────────────────────────────────────────── */
.rest-toolbar {
  display:flex; flex-direction:column; gap:10px; margin-bottom:16px;
}
.rest-cat-filter {
  display:flex; gap:8px; overflow-x:auto; padding-bottom:4px; scrollbar-width:none;
}
.rest-cat-filter::-webkit-scrollbar { display:none; }
.rest-chip {
  flex-shrink:0; padding:7px 14px; border-radius:20px;
  border:1px solid var(--border); background:var(--surface); color:var(--text-dim);
  font-family:'Heebo',sans-serif; font-size:13px; font-weight:500;
  cursor:pointer; transition:all .2s; white-space:nowrap;
  -webkit-tap-highlight-color:transparent;
}
.rest-chip.active { background:var(--blue); border-color:var(--blue); color:white; font-weight:700; }
.rest-chip-edit  { background:rgba(212,168,67,.1); border-color:rgba(212,168,67,.3); color:var(--gold); }
.proximity-btn {
  width:100%; background:linear-gradient(135deg,rgba(45,212,160,.2),rgba(26,111,181,.15));
  border:1px solid rgba(45,212,160,.4); color:var(--green);
  border-radius:12px; padding:12px; font-family:'Heebo',sans-serif;
  font-size:14px; font-weight:700; cursor:pointer;
  display:flex; align-items:center; justify-content:center; gap:8px;
  transition:transform .15s; -webkit-tap-highlight-color:transparent;
}
.proximity-btn:active { transform:scale(.97); }

.rest-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:var(--radius); padding:16px; margin-bottom:12px;
  position:relative; overflow:hidden;
}
.rest-card::before {
  content:''; position:absolute; right:0; top:0; bottom:0; width:3px;
  background:linear-gradient(180deg,var(--gold),#a07020);
}
.rest-rank {
  position:absolute; left:14px; top:14px;
  background:linear-gradient(135deg,var(--gold),#a07020); color:#000;
  width:26px; height:26px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:12px; font-weight:900;
}
.rest-cat-badge {
  display:inline-flex; align-items:center; gap:4px;
  padding:3px 10px; border-radius:20px; border:1px solid;
  font-size:11px; font-weight:600; margin-bottom:6px;
}
.rest-name { font-size:17px; font-weight:700; margin-bottom:4px; padding-left:36px; }
.rest-desc { font-size:13px; color:var(--text-dim); margin-bottom:6px; line-height:1.5; }
.rest-meta { font-size:12px; color:var(--text-dim); margin-bottom:0; line-height:1.8; }
